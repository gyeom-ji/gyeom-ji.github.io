---
title: "CPU 기능과 동작"
author: gyeomji
date: 2024-07-08 10:00:00 +0900
categories: [Computer Architecture]
tags: [CPU, CU, Pipelining, IC, MachineCycle]
pin: false
math: true
mermaid: true
---

<br/>

## CPU 기능

---

- CPU가 모든 명령어들에 대해 공통적으로 수행되는 기능은 명령어 인출(Instruction Fetch)과 명령어 해독(Instruction Decode)이다.
- 추가되는 명령어 기능은 데이터 인출, 데이터 처리, 데이터 쓰기 기능이 있다.
- 데이터 인출(data fetch) 기능 : 명령어 실행을 위해 데이터가 필요한 경우 기억장치 또는 입출력 장치에서 그 데이터를 읽어오는 과정이다.
  - 연산과정에서 사용하는 데이터를 불러오는 과정이라 할 수 있다.
- 데이터 처리(data process) 기능 : 읽어온 데이터에 대한 산술적 또는 논리적 연산을 수행한다.
- 데이터 쓰기(data store) 기능 : 데이터 처리 과정에서의 수행 결과를 저장한다.

<br/>


### CPU와 주기억장치의 데이터 전송


![systemBus](/assets/img/systemBus4.png)

<br/>


## CPU 동작

---

- CPU는 4단계의 기본 동작으로 구성된다.
- 누산기(Accumulator) : 데이터 레지스터로 처리 결과를 임시로 보유하는 역할

![cpu4Movement](/assets/img/cpu4Movement.png)

1. 처리해야 할 데이터는 주기억장치 RAM에서 인출되고 외부 시스템 버스를 통해서 레지스터 1번으로 전달된다.
2. 제어장치는 새롭게 저장된 레지스터 1번 데이터와 이전부터 저장하고 있던 레지스터 2번의 데이터를 덧셈하라는 제어신호를 ALU로 전달한다.
3. ALU는 제어신호에 의해 덧셈을 수행하고 그 결과를 누산기에 저장한다. 
4. 덧셈의 계산 결과는 외부 시스템 버스를 통해 다시 주기억장치로 전달된다.


<br/>

### 머신 사이클 machine cycle

- 프로그램을 구성하는 명령어는 4단계의 과정을 통해서 수행한다.
- 이 과정은 CPU에서 동작하므로 머신 사이클이라 한다.
- 인출, 해독, 실행, 저장 사이클이 있다.

![machineCycle](/assets/img/machineCycle.png)

#### 인출 사이클 Fetch Cycle

- 필요한 명령어를 주기억장치에서 불러온다.

#### 해독 사이클 Decode Cycle

- 호출된 명령어를 해석한다.

#### 실행 사이클 Excute Cycle

- 해석된 명령어를 산술논리연산장치를 통해 실행한다.

#### 저장 사이클 Store Cycle

- 수행결과를 주기억장치에 저장한다.

<br/>

## 제어장치의 기본 동작 

---

- 주기억장치에서 명령어를 인출해 제어장치 내 명령어 레지스터 IR에 저장된다.
- PC에는 다음에 실행될 명령어의 주소가 저장된다. (인출)
- 제어장치가 명령어 레지스터의 명령어를 해석한다. (해독)
- 해석된 명령어는 해당되는 제어신호를 발생한다. (실행)

![controlUnitMovement](/assets/img/controlUnitMovement.png)

<br/>

### PC의 역할 

- 프로그램에서 항상 앞에서부터 한 명령씩 차례대로 실행되도록 한다.
- 조건부 분기(예: JUMP)와 같이 그 순서를 바꾸어야 하는 경우, 프로그램 카운터의 내용을 바꿈으로써 분기된 이후부터의 명령들이 새로운 순서에 맞게 실행된다.

![programCounter](/assets/img/programCounter.png)

<br/>

## 제어장치 동작을 포함한 CPU의 동작

---

![cpuMovement](/assets/img/cpuMovement.png)


<br/> 

### 프로그램내 명령어가 수행되는 과정

- 컴퓨터 동작은 프로그램 내 명령을 읽고 처리하고 저장하는 과정을 통해 정해진 순서대로 프로그램을 실행한다.

1. 명령어 인출 : 명령어를 읽어가지고 오는 단계
2. 명령어 해독 : 명령어의 내용을 결정하는 단계
3. 명령어 실행 : 해독 명령어의 내용을 수행하는 과정으로 처리 결과는 저장
4. 프로그램 카운터 증가 단계 : 다음 명령어를 수행하기 위한 단계

<br/> 

### 명령어 사이클 (Instruction Cycle, IC)


- CPU가 하나의 명령어를 실행하는데 필요한 전체 처리 과정이다.

![instructionCycle](/assets/img/instructionCycle.png)

- 명령어 사이클은 기본적으로 인출 사이클(fetch cycle)과 실행 사이클(execution cycle)의 부 사이클 두 개로 구성되어 있다.
- 인출 사이클은 CPU가 주기억장치로부터 명령어를 읽어오는 단계다.
- 실행 사이클은 명령어를 실행하는 단계다.
  - CPU는 실행 사이클 동안에 명령어 코드를 해독(decode)하고, 그 결과에 따라 필요한 연산들을 수행한다.
  - 실행되는 동작은 전송, 연산, 제어로 분류한다.
  - 전송
    - 프로세서와 기억장치 간에 데이터가 전송된다.
    - 프로세서와 I/O 모듈 간 데이터가 전송된다.
  - 연산
    - 데이터에 대해 지정된 산술 혹은 논리 연산이 수행된다.
  - 제어
    - 점프와 같이 실행 명령어의 순서가 변경될 때 사용된다.

<br/>


#### Fetch cycle 인출 사이클의 3단계 과정

![instructionCycle](/assets/img/instructionCycle1.jpeg)

##### ① t0 

- PC(Program Counter)에 저장되어 있는 현재 명령어의 위치를 CU(Control Unit)의 제어에 따라 MAR(Memory Address Register)에 저장한다.
   > 데이터가 메모리에 올라가며 동시에 명령의 시작 번지가 CPU의 PC 레지스터에 저장된다.
- MAR에 저장된 주소를 address bus에 배치시킨다.
- CU가 read signal을 발생시키기 위해 control bus에 read state를 배치시킨다.

##### ② t1 

- address bus의 주소를 참조하여 메모리에서 해당 주소에 해당하는 값을 읽어 data bus에 배치시킨다.
- data bus에 배치된 명령 또는 데이터를 MBR(Memoru Buffer Register)에 불러들인다.
- PC의 메모리 주소가 다음 주소로 증가한다.
   - CPU처리 단위 bit에 따라 주소 증가 값이 다르다.

##### ③ t2 

- MBR의 명령어가 현재 실행 중인 명령을 보관하는 IR(Instruction Register)에 복사된다.

<br/>

#### Execution cycle

- CPU는 실행 사이클 동안에 명령어 코드를 해독(decode)하고, 그 결과에 따라 필요한 연산들을 수행한다.

##### Decode 해석

- CU의 디코더에서 IR에 저장된 명령어를 해석한다.

##### Execute 수행

- 해석된 명령어에 따라 데이터에 대한 명령을 수행한다.

##### Write Back 저장

- MAR에 저장된 주소 번지에 해당하는 주기억장치 위치에 MBR에 저장되어 있는 데이터를 저장한다.
- 결과값을 기다리는 명령어가 있을 경우 결과값이 생긴 것을 알려준다.


#### ADD 명령어 실행 사이클 3단계 과정

- ADD : 기억장치에 저장된 데이터를 AC(Accumulator, 누산기)의 내용과 더하고, 그 결과는 다시 AC에 저장하는 명령어다.

![instructionCycle](/assets/img/instructionCycle2.png)

##### ① t0 

- MBR에 저장될 데이터의 기억장치 주소를 MAR로 전송한다.
- MAR에 저장된 주소를 address bus에 배치시킨다.

##### ② t1 

- address bus의 주소를 참조하여 메모리에서 해당 주소에 해당하는 값을 읽어 data bus에 배치시킨다.
- data bus에 배치된 저장할 데이터를 MBR(Memoru Buffer Register)에 불러들인다.

##### ③ t2 

- MBR의 데이터와 AC의 내용을 더하고 결과값을 다시 AC에 저장한다.

<br/>

## CPU 성능 요소

---

- CPU의 성능이란 얼마나 빠르게 메모리로부터 명령이나 데이터를 가져오느냐이다.
  - 즉, CPU의 속도는 성능과 직결된다.
- CPU가 데이터를 처리하는 속도는 컴퓨터의 성능을 평가하는 중요 요인으로, 여러 요소들에 의해 좌우된다.
- 대표적인 요소들에는 클록(Clock) 주파수, 워드(Word) 크기, 캐시 메모리, 명령어 집합의 복합성, 파이프라이닝(Pipelining), 병렬 처리(Parallel Processing)가 있다.

<br/>

### 클록 Clock 주파수

- CPU가 일정한 속도로 작동하기 위해 일정한 간격으로 공급되는 전지적 진동(pulse)을 클록이라 한다.
  - 컴퓨터에서 수행되는 모든 연산의 타이밍을 맞추기 위한 진동이다.
- 1초에 클록이 몇 번 발생하는지 나타낸 것을 클록 주파수라 하며 단위는 Hz이다.
  - 1초에 1번 클록이 발생하는 것을 1Hz라고 한다.
- 클록 주파수는 컴퓨터가 명령어를 수행하는 속도를 결정한다.
  - 한 클록 동안 명령어 부 사이클이 수행된다.
  - 클록 주기가 길면 그만큼 처리할 수 있는 명령어 부 사이클 시간이 지연된다.
  - 클록 수가 높을수록 컴퓨터의 처리 속도가 빠르다는 것을 의미한다.
  - 클록의 주기는 클록의 주파수와 반비례하므로 짧은 주기는 높은 클록 주파수를 뜻한다.
- 결과적으로 클록 주파수는 특정시간 동안 완수할 수 있는 명령어의 수를 제한한다.

<br/>

### 워드 크기

- CPU가 한 번에 읽고(read), 쓸(write) 수 있는 비트 수다.
- 워드의 크기는 레지스터의 크기와 버스의 데이터 선로 수에 달려 있다.
- 워드 크기가 큰 컴퓨터는 한 명령어에서 더 많은 데이터를 처리할 수 있다.

<br/>

### 캐시기억장치

- 캐시기억장치는 CPU가 데이터에 빠르게 접근할 수 있는 고속의 기억장치다.
- 읽기와 쓰기 동작의 속도를 향상시켜서 전체적으로 CPU 속도에 영향을 준다.

<br/>

### 명령어 집합의 복잡성

- 축소 명령어 집합 컴퓨터(RISC, Reduced Instruction Set Computer)는 연산속도를 향상 시키기 위해 제어논리를 단순화하고 단순화된 명령어 구조를 가진다.
- 특별한 설계 방법을 통해 속도를 최대한 높일 수 있는 컴퓨터다.

<br/>

### 파이프라이닝(Pipelining) 기법

- 파이프들이 연속적으로 연결되는 개념이다.
- CPU 또는 프로세서가 이전 명령어의 수행이 완전하게 종료되기 전에 새로운 다음 명령어 수행을 시작하는 기법이다.

#### 파이프라이닝 동작원리

![pipelining](/assets/img/pipelining.png)

- 제어장치가 3번 명령어를 해독하는 동안 2번 명령어에 필요한 데이터는 레지스터로 이동하고 1번 명령어는 누산기에서 수행을 마친다.
- 명령어들의 부 사이클이 동시간에 처리될 수 있어 CPU의 처리속도를 증가 시킬 수 있다.

<br/>

### 병렬 처리 Parallel processing

- 두개 이상의 CPU로 구성된 컴퓨터에서 한 번에 여러 개의 명령어를 동시에 수행시킬 수 있는 방법이다.

#### 병렬처리 동작 원리

![parallelprocessing](/assets/img/parallelprocessing.png)

- 3개의 CPU가 존재한다.
- 명령어가 제어장치로 입력되면 제어장치는 해당 명령어가 수행 가능한 CPU로 보낸다.
- 여분의 CPU가 다른 명령어를 처리할 수 있으므로 대기하는 시간 없이 바로 처리된다.
- 여러 개의 CPU가 필요하므로 비용이 상승하지만 그만큼 컴퓨터가 처리하는 속도는 증가하게 된다.

<br/>
<br/>

[^footnote]: The footnote source
[^fn-nth-2]: The 2nd footnote source
